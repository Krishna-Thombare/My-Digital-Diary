{% set feature_css = 'notes' %}
{% extends "base.html" %}
{% block content %}

<div class="notes-header-section">
    <div class="d-flex justify-content-between align-items-center mb-2">
        <div class="d-flex align-items-center">
            <a href="{{ url_for('notes.notes_list') }}" class="notes-icon-btn">‚Üê</a>
            <span class="notes-label ms-2">Back</span>
        </div>

        <h2 class="text-center flex-grow-1 notes-title">New Note</h2>

        <div class="d-flex align-items-center">
            <span class="notes-label me-2">Save</span>
            <button form="noteForm" type="submit" class="notes-icon-btn">‚úì</button>
        </div>
    </div>
</div>

<div class="notes-diary-box">
    <form id="noteForm" method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="notes-header d-flex align-items-center gap-2">
            <span class="journal-date">{{ current_date }}</span> -

            <div class="flex-grow-1 d-flex gap-2 align-items-center">
                {{ form.note_name(class="notes-topic-input", placeholder="Note Title...") }}
                
                <label for="image" class="notes-image-btn">üì∑ Add Image</label>
                <input type="file" id="image" name="image" accept="image/*" style="display: none;">
            </div>
        </div>
        <hr class="notes-line">

        <div class="notes-body">
            <!-- Hidden textarea for form submission -->
            <textarea name="notes" id="notes-hidden" style="display:none;"></textarea>

            <!-- Floating Image Preview -->
            <img id="image-preview" src="" alt="Image Preview" class="floating-image" style="display: none;">

            <!-- Editable div that mimics a textarea -->
            <div id="notes-editor" class="notes-textarea" contenteditable="true"
                placeholder="Write your notes here...">
                {{ form.notes.data if form.notes.data else '' }}
            </div>
            
            <div class="clearfix"></div>
            <hr class="line">

            {{ form.source_links(class="notes-textarea", rows="4", placeholder="Source links (optional)...") }}
        </div>

    </form>

</div>

<script src="{{ url_for('static', filename='js/notes_add.js') }}"></script>

{% endblock %}
